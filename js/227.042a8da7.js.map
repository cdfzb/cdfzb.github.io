{"version":3,"file":"js/227.042a8da7.js","mappings":"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","sources":["webpack://betly-dapp/./src/components/swapAlert.vue","webpack://betly-dapp/./src/components/swapAlert.vue?6f3c","webpack://betly-dapp/./src/views/Exchange/index.vue","webpack://betly-dapp/./src/views/Exchange/index.vue?853a"],"sourcesContent":["<script setup>\nimport { ref, reactive, toRefs } from 'vue';\nimport popupTitle from '@/components/popupTitle.vue';\nimport { commonStore } from '@/store/common';\nimport useClipboard from 'vue-clipboard3';\nimport { Toast } from '_vant@3.4.8@vant';\nimport loadingIcon from './loadingIcon.vue';\n\nconst props = defineProps({\n  finish: Boolean,\n  success: Boolean,\n  hash: String,\n  type: String,\n  text: String,\n  title: String,\n  btn: String,\n});\n\nconst { hash } = toRefs(props);\nconst emit = defineEmits(['closeFn']);\nconst common_store = commonStore();\nconst { toClipboard } = useClipboard();\n</script>\n<template>\n  <div class=\"bind allFlex column\">\n    <span\n      class=\"success-btn Wcolor font-Two\"\n      :class=\"[success ? 'btnBg' : 'redBg']\"\n      v-show=\"finish\"\n      >{{ success ? $t('success') : $t('fail') }}</span\n    >\n    <loading-icon class=\"loading\" v-show=\"!finish\"></loading-icon>\n    <p class=\"popup-title Wcolor font-Eight font500 center\">\n      {{ $t(title) }}\n    </p>\n    <div class=\"bind_ipt center Wcolor\" v-if=\"!finish\">\n      <slot></slot>\n    </div>\n\n    <div\n      class=\"bind_ipt bgPadding center\"\n      :class=\"[success ? 'mainColor font-Ty' : 'redColor hashFont font-Four']\"\n      v-if=\"finish\"\n    >\n      {{ success ? $t(text) : hash }}\n    </div>\n    <div class=\"bgPadding\">\n      <van-button class=\"btn\" type=\"primary\" block v-show=\"!finish\">{{\n        $t(btn)\n      }}</van-button>\n      <van-button\n        class=\"btn\"\n        :type=\"success ? 'primary' : 'danger'\"\n        block\n        v-show=\"finish\"\n        @click=\"$emit('closeFn')\"\n        >{{ $t('SwapAlert.close') }}</van-button\n      >\n    </div>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.popup-title {\n  position: relative;\n  height: 50px;\n  line-height: 50px;\n}\n.bind {\n  width: 315px;\n  height: 230px;\n  background: url('../assets/commonImg/alert-bg1.png') no-repeat;\n  background-size: 100% 100%;\n  position: relative;\n  padding: 4px 4px 40px 4px;\n  &_ipt {\n    text-overflow: ellipsis;\n    word-break: break-all;\n    padding: 15px;\n    line-height: 30px;\n    max-height: 120px;\n    overflow-y: scroll;\n  }\n}\n.loading {\n  position: absolute;\n  top: 15px;\n  right: 15px;\n}\n.success-btn {\n  padding: 2px 6px;\n  border-radius: 4px;\n  transform: scale(0.8);\n  position: absolute;\n  top: 15px;\n  right: 10px;\n}\n</style>\n","import script from \"./swapAlert.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./swapAlert.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./swapAlert.vue?vue&type=style&index=0&id=4ee0a202&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-4ee0a202\"]])\n\nexport default __exports__","<script setup>\nimport { ref, reactive, onBeforeMount, watch, watchEffect } from 'vue';\n// import coinIpt from './components/coinIpt.vue';\nimport { swapStore } from '@/store/swap';\nimport { commonStore } from '@/store/common';\nimport swapAlert from '@/components/swapAlert.vue';\nimport { Toast } from '_vant@3.4.8@vant';\nimport { useI18n } from 'vue-i18n';\nimport { balanceUtil, numberUtils } from '@/utils';\nimport { MaxUint256 } from '@ethersproject/constants';\nconst icon1 = require('@assets/exchangeImg/icon1.png');\nconst icon2 = require('@assets/exchangeImg/icon2.png');\nconst swap_store = swapStore();\nconst common_store = commonStore();\nconst { t } = useI18n();\nconst data = reactive({\n  tokenBal: '',\n  usdtBal: '',\n  usdt: '',\n  token: '',\n  check: false,\n  usdtFocus: false,\n  tokenFocus: false,\n  alertShow: false,\n  finish: false,\n  success: false,\n  hash: '',\n  hashType: 2,\n  showPopover: false,\n});\n\nconst getUsdtBal = async () => {\n  const res = await swap_store.usdtMethods\n    .balanceOf(common_store.address)\n    .call();\n  data.usdtBal = balanceUtil(res + '');\n  console.log(res);\n  console.log(data);\n};\nconst getTokenBal = async () => {\n  const res = await swap_store.tokenMethods\n    .balanceOf(common_store.address)\n    .call();\n  data.tokenBal = balanceUtil(res + '');\n};\nonBeforeMount(async () => {\n  if (!swap_store.tokenEmpower) {\n    await swap_store.getTokenMethods();\n  }\n  if (!swap_store.usdtEmpower) {\n    await swap_store.getUsdtMethods();\n  }\n});\nwatchEffect(() => {\n  if (common_store.address && swap_store.usdtEmpower) {\n    getUsdtBal();\n    getTokenBal();\n  }\n});\nwatch(\n  () => data.usdt,\n  (val) => {\n    if (!data.tokenFocus) {\n      if (!data.check) {\n        data.token = val;\n      } else {\n        data.token = val ? Number(val / 0.95).toFixed(1) : '';\n      }\n    }\n  }\n);\nwatch(\n  () => data.token,\n  (val) => {\n    if (!data.usdtFocus) {\n      if (!data.check) {\n        data.usdt = val;\n      } else {\n        data.usdt = val ? Number(val * 0.95).toFixed(1) : '';\n      }\n    }\n  }\n);\nwatch(\n  () => data.check,\n  (val) => {\n    data.value = '';\n    data.usdt = '';\n    data.token = '';\n    data.usdtFocus = false;\n    data.tokenFocus = false;\n  }\n);\nconst toSwap = async () => {\n  const value = data.check ? data.token : data.usdt;\n  if (!value) {\n    Toast(t('Swap.number'));\n    return;\n  }\n  await swap_store.getUsdtMethods();\n  await swap_store.getTokenMethods();\n  if (!swap_store.marketEmpower && data.check) {\n    common_store.setEmpowerType(4);\n    common_store.showEmpower(true);\n    return;\n  }\n  if (!swap_store.usetMarketEmpower && !data.check) {\n    common_store.setEmpowerType(3);\n    common_store.showEmpower(true);\n    return;\n  }\n  const index = data.check ? 1 : 0;\n  data.hashType = !data.check ? 2 : 3;\n\n  data.alertShow = true;\n  data.finish = false;\n  data.success = false;\n\n  try {\n    const res = await common_store.marketMethods\n      .swap(index, numberUtils(value, 18))\n      .send({ from: common_store.address });\n    data.token = '';\n    data.usdt = '';\n    data.finish = true;\n    data.success = true;\n    data.hash = res.transactionHash;\n    common_store.addHash(data.hash, data.hashType);\n    getUsdtBal();\n    getTokenBal();\n  } catch (error) {\n    data.finish = true;\n    data.success = false;\n    data.hash = error.message;\n  }\n};\nconst toEmpower = async () => {\n  if (!data.check) {\n    try {\n      console.log(swap_store.usdtMethods);\n      const res = await swap_store.usdtMethods\n        .approve(swap_store.marketSpender, MaxUint256)\n        .send({ from: common_store.address });\n      swap_store.setUsdtEmpower();\n    } catch (error) {\n      console.log(error);\n      Toast(error);\n    }\n  } else {\n    try {\n      const res = await swap_store.tokenMethods\n        .approve(swap_store.marketSpender, MaxUint256)\n        .send({ from: common_store.address });\n      swap_store.setMarketEmpower();\n    } catch (error) {\n      Toast(error);\n    }\n  }\n};\n</script>\n<template>\n  <div class=\"padding\">\n    <div class=\"exchange-main titleBg\">\n      <div class=\"main\" :class=\"[data.check ? 'end' : 'start']\">\n        <ul class=\"coin-ipt allFlex column\">\n          <li class=\"flex_between\">\n            <input\n              type=\"number\"\n              class=\"Wcolor font-Tt Bold\"\n              v-model=\"data.usdt\"\n              placeholder=\"0.0\"\n              @focus=\"data.usdtFocus = true\"\n              @blur=\"data.usdtFocus = false\"\n            />\n            <div class=\"flex_start coin-bg\">\n              <div class=\"icon\">\n                <van-popover\n                  v-model:show=\"data.showPopover\"\n                  class=\"coin-popover\"\n                  placement=\"bottom\"\n                >\n                  <p class=\"font-Two Wcolor question-p\">\n                    BNB Smart Chain(BEP20)\n                  </p>\n                  <template #reference>\n                    <img\n                      src=\"@assets/exchangeImg/icon1.png\"\n                      alt=\"\"\n                      class=\"icon\"\n                    />\n                  </template>\n                </van-popover>\n              </div>\n\n              <span class=\"Wcolor marginTen font-Two\">USDT</span>\n\n              <!-- <div class=\"question\">\n                <van-popover v-model:show=\"data.showPopover\" placement=\"left\">\n                  <p class=\"font-Two Wcolor question-p\">\n                    BNB Smart Chain(BEP20)\n                  </p>\n                  <template #reference>\n                    <img\n                      src=\"@assets/exchangeImg/question.png\"\n                      alt=\"\"\n                      class=\"question_icon\"\n                    />\n                  </template>\n                </van-popover>\n              </div> -->\n            </div>\n          </li>\n          <li>\n            <span class=\"priceColor font-Two\"\n              >{{ $t('balance') }}：{{ Number(data.usdtBal) }}</span\n            >\n          </li>\n        </ul>\n        <div class=\"exchange-main_icon flex_end padding\">\n          <img\n            src=\"@assets/exchangeImg/exchange_icon.png\"\n            alt=\"\"\n            class=\"exchange_icon\"\n            @click=\"data.check = !data.check\"\n          />\n        </div>\n        <ul class=\"coin-ipt allFlex column\">\n          <li class=\"flex_between\">\n            <input\n              type=\"number\"\n              class=\"Wcolor font-Tt Bold\"\n              @focus=\"data.tokenFocus = true\"\n              @blur=\"data.tokenFocus = false\"\n              v-model=\"data.token\"\n              placeholder=\"0.0\"\n            />\n            <div class=\"flex_start coin-bg\">\n              <img src=\"@assets/exchangeImg/icon2.png\" alt=\"\" class=\"icon\" />\n              <span class=\"Wcolor marginTen font-Two\">SkyT</span>\n            </div>\n          </li>\n          <li class=\"\">\n            <span class=\"priceColor font-Two\"\n              >{{ $t('balance') }}：{{ Number(data.tokenBal) }}</span\n            >\n          </li>\n        </ul>\n      </div>\n\n      <div class=\"btn\">\n        <!-- <van-button\n          type=\"default\"\n          block\n          v-if=\"!swap_store.marketEmpower || !swap_store.usetMarketEmpower\"\n          @click=\"toEmpower\"\n          >授权SkyT</van-button\n        > -->\n        <van-button type=\"primary\" block @click=\"toSwap\">{{\n          $t('Swap.btn')\n        }}</van-button>\n      </div>\n    </div>\n    <van-popup v-model:show=\"data.alertShow\" :close-on-click-overlay=\"false\">\n      <swap-alert\n        :finish=\"data.finish\"\n        :success=\"data.success\"\n        :hash=\"data.hash\"\n        title=\"SwapAlert.title1\"\n        text=\"SwapAlert.success1\"\n        btn=\"SwapAlert.btn1\"\n        @closeFn=\"data.alertShow = false\"\n        type=\"swap\"\n      >\n        <p class=\"font-Four\">\n          {{\n            data.hashType == 2\n              ? $t('Swap.type1', { token: data.token, usdt: data.usdt })\n              : $t('Swap.type2', { token: data.token, usdt: data.usdt })\n          }}\n        </p>\n      </swap-alert>\n    </van-popup>\n  </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.exchange-main {\n  padding: 30px 15px;\n  min-height: 400px;\n  border-radius: 20px;\n  &_icon {\n    margin: -10px 0;\n    position: relative;\n    z-index: 99;\n    img {\n      width: 40px;\n    }\n  }\n}\n.exchange_icon {\n  width: 38px;\n  height: 38px;\n}\n.btn {\n  margin-top: 35px;\n  .van-button {\n    margin-top: 20px;\n  }\n}\n.main {\n  display: flex;\n  justify-content: space-between;\n}\n.end {\n  flex-direction: column-reverse;\n}\n.start {\n  flex-direction: column;\n}\n.icon {\n  width: 25px;\n  height: 25px;\n}\n.coin-ipt {\n  background: #35404d;\n  border-radius: 15px;\n  padding: 15px;\n  height: 100px;\n  position: relative;\n  li:first-child {\n    height: 50px;\n  }\n  .coin-bg {\n    width: 88px;\n    height: 32px;\n    background: #4b566c;\n    border-radius: 16px;\n    padding-left: 2px;\n    position: relative;\n  }\n  input {\n    width: calc(100% - 90px);\n  }\n}\n.question_icon {\n  width: 18px;\n}\n.question {\n  // position: absolute;\n  // top: -14px;\n  // left: 20px;\n  &-p {\n    padding: 4px 10px;\n    background: #415367;\n  }\n}\n</style>\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=c977b40e&lang=scss&scoped=true\"\n\nimport exportComponent from \"/Users/zhuweiyun/Desktop/zwy/vue3-天空之城/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c977b40e\"]])\n\nexport default __exports__"],"names":["hash","toRefs","props","toClipboard","commonStore","useClipboard","__exports__","require","swap_store","swapStore","common_store","t","useI18n","data","reactive","tokenBal","usdtBal","usdt","token","check","usdtFocus","tokenFocus","alertShow","finish","success","hashType","showPopover","getUsdtBal","async","res","usdtMethods","balanceOf","address","call","balanceUtil","console","log","getTokenBal","tokenMethods","onBeforeMount","tokenEmpower","getTokenMethods","usdtEmpower","getUsdtMethods","watchEffect","watch","val","Number","toFixed","value","toSwap","Toast","marketEmpower","setEmpowerType","showEmpower","usetMarketEmpower","index","marketMethods","swap","numberUtils","send","from","transactionHash","addHash","error","message"],"sourceRoot":""}